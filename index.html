<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>NEAT Hunting and Fogaring Simulation</title>
    <script type="text/javascript" src="http://73.225.31.4:8888/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript" src="./util.js"></script>
    <script type="text/javascript" src="./data/genometracker.js"></script>
    <script type="text/javascript" src="./data/agenttracker.js"></script>
    <script type="text/javascript" src="./entities/agentutil.js"></script>
    <script type="text/javascript" src="./entities/agent.js"></script>
    <script type="text/javascript" src="./data/foodtracker.js"></script>
    <script type="text/javascript" src="./data/graphutils.js"></script>
    <script type="text/javascript" src="./entities/food.js"></script>
    <script type="text/javascript" src="./entities/home.js"></script>
    <script type="text/javascript" src="./entities/wall.js"></script>
    <script type="text/javascript" src="./profiles/profile.js"></script>
    <script type="text/javascript" src="./neuralnetwork/custommaptypes.js"></script>
    <script type="text/javascript" src="./neuralnetwork/neuralnetutil.js"></script>
    <script type="text/javascript" src="./neuralnetwork/neuralnet.js"></script>
    <script type="text/javascript" src="./neuralnetwork/genome.js"></script>
    <script type="text/javascript" src="./histogram.js"></script>
    <script type="text/javascript" src="./linechart.js"></script>
    <script type="text/javascript" src="./entities/world.js"></script>
    <script type="text/javascript" src="./boundingcircle.js"></script>
    <script type="text/javascript" src="./assetmanager.js"></script>
    <script type="text/javascript" src="./datadisplay.js"></script>
    <script type="text/javascript" src="./timer.js"></script>
    <script type="text/javascript" src="./minimap.js"></script>
    <script type="text/javascript" src="./population.js"></script>
    <script type="text/javascript" src="./gameengine.js"></script>
    <script type="text/javascript" src="./graph.js"></script>
    <script type="text/javascript" src="./main.js"></script>

    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
</head>

<body>
    <!-- <canvas id="gameWorld" width="800" height="800" style="background: white; border: 1px solid black" tabindex="0"></canvas> -->
    <div style="display:flex; flex-wrap: inherit;">
        <div id="carouselCanvasIndicators" class="carousel carousel-dark" style="margin: auto;" data-bs-ride="carousel">
            <div>
                <h1><strong>Main Display:</strong></h1>
            </div>
            <div id="canvas-indicators" class="carousel-indicators">
            </div>
            <div style="
            display: flex;
            width: 1005px; " id="canvas-carousel" class="carousel-inner">
            </div>
            <button id="main-canvas-back" class="carousel-control-prev" type="button"
                data-bs-target="#carouselCanvasIndicators" style="float:left;" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button id="main-canvas-next" class="carousel-control-next" type="button"
                data-bs-target="#carouselCanvasIndicators" style="float:right; " data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>

        <div class="container" id="minimapContainters" style="margin: auto;">
            <div>
                <h1><strong>Minimap: </strong><br></h1>
            </div>
        </div>
    </div>
    <br>

    <div style="display:flex; flex-wrap:wrap; width: fit-content; ">
        <div class="container" style="width: fit-content; border: 2px solid black">
            <div>
                <h1><strong>General Simulation Settings:</strong></h1>
            </div>
            <div>
                Generation Time (ticks): <input type="text" id="generation_time" value="700">
            </div>

            <div>
                Species Compatibility Threshold: <input type="text" id="compat_threshold" value="0.07">
            </div>

            <div>
                Default K Value (Requires restart): <input type="text" id="genome_default_k_val" value="0.75">
            </div>

            <div>
                Tick to update current generation output data: <input type="text" id="tickToUpdateCurrentGenOutputData"
                    value="0">
            </div>

            <div>
                <input type="checkbox" id="coevolution"> Coevolution
            </div>

            <div>
                <input type="checkbox" id="split_species"> Split Species
            </div>
            <div>
                <input type="checkbox" id="rand_default_weights" checked="true"> Randomize Default Genome Weights
                (restart
                to
                take effect)
            </div>
            <div>
                <input type="checkbox" id="evolveKandM" checked="true"> Evolve K and M
            </div>

            <div>
                <input type="checkbox" id="draw_agent_vision_cone"> Draw Vision Rays (only for cone vision)
                <br>

                <input type="checkbox" id="pauseDrawing" name="pauseDrawing">
                <label for="pauseDrawing" id="pauseDrawingLabel">
                    Pause Drawing (To speed up the simulation)
                </label>
                &emsp;
                <input type="checkbox" id="display_minimap" checked=true> Display minimap

            </div>

            <div>

                <input type="checkbox" id="runByProfileMode"> Enable run by profile mode
                <br>
                <select name="profileOption" id="profileOption">
                </select>
                <br>
                <br>
                <button type="button" id="loadProfile"> Load Profile </button>
                &emsp;
                <button type="button" id="restart_sim" type="button">Restart Simulation</button>
                &emsp;
                <button type="button" id="pause_sim" type="button" style="background-color: green; color:white;">
                    Pause
                    Simulation</button>

            </div>

            <br>
        </div>

        <div class="container" style="border: 2px solid black; width: fit-content;">
            <h1><strong>Database Setting:</strong></h1>
            <label for="save_to_db"> Enable Saving: </label>
            <input type="checkbox" id="save_to_db">
            <br>
            <label for="db"> Database Name: </label>
            <input type="text" id="db" value="testDB">
            <br>
            <label for="db_collection"> Collection Name: </label>
            <input type="text" id="db_collection" value="NEATtests">

            <br>
            <label for="gen_to_save"> Generation to Save to DB: </label>
            <input type="text" id="gen_to_save" value="40">
            <br>
            <label for="sim_trial_num"> Simulation Trials </label>
            <input type="text" id="sim_trial_num" value=3>
            <br>
            <button type="button" id="db_download_data" style="background-color: red; color:white;"> Download Data
            </button>
            <h1><strong>Genome Database Setting:</strong></h1>
            Genome Enable Saving: <input type="checkbox" id="auto_save_genome">
            <br>
            <label for="auto_save_genome">
            </label>
            <label for="genome_db"> Genome Database Name: </label>
            <input type="text" id="genome_db" value="test">
            <br>
            <label for="genome_db_collection"> Genome Collection Name: </label>
            <input type="text" id="genome_db_collection" value="NEATGenomeTests1">
            <br>
            <label for="gen_to_save_genome"> Genome Generation to Auto-Save to DB: </label>
            <input type="text" id="gen_to_save_genome" value="100">
            <br>
            <button type="button" id="db_save_genome" style="background-color: red; color:white;"> Save Genome
            </button>
            <br>
            <button type="button" id="db_download_genome" style="background-color: red; color:white;"> Download
                Genome
            </button>
            <br></br>
        </div>
    </div>
    <div style="display:flex; flex-wrap:inehrit; width: fit-content;    ">
        <div class="container" style="border: 2px solid black; width: fit-content;">
            <div>
                <h1><strong>Food Setting:</strong></h1>
            </div>

            <div>
                <div>
                    <input type="checkbox" id="enforce_min_food" checked="true"> Enforce Minimum Food
                </div>
                <input type="checkbox" id="no_decaying" checked="true"> No decaying food
                &emsp;
                <br>

                <input type="checkbox" id="randomizing_food_spawn_pattern" checked="true"> Randomize food spawning
                pattern
                <br>

                <label for="caloriesPerFood"> Calories reward per food: </label>
                <input type="text" id="caloriesPerFood" value="50">
                <br>
                <br>
                <div>
                    <input type="checkbox" id="moving_food"> Moving food
                    &emsp;
                    <label for="movingFoodPattern">Food moving pattern: </label>
                    <select name="movingFoodPattern" id="movingFoodPattern">
                        <option value="drunkenSailor">Drunken Sailor</option>
                        <option value="direct">Direct</option>
                    </select>

                    &emsp;
                    <br><label for="food_velocityX"> Velocity X: </label>
                    <input type="text" id="food_velocityX" value="1">

                    <br><label for="food_velocityY">Velocity Y: </label>
                    <input type="text" id="food_velocityY" value="1">
                </div>
                <br>
            </div>
            <div>
                <input type="checkbox" id="inner_wall"> Inner Walls
                &emsp;
                <input type="checkbox" id="no_border"> No border (Restart to take effect)
            </div>
            <div>
                <input type="checkbox" id="largeEnergyThresh"> Large Energy Threshold
            </div>
            <br>
            <div>
                Food Diameter: <input type="text" id="food_diameter" value="24"> <br>
            </div>

            <div>
                Food to Agent Ratio:<input type="text" id="food_agent_ratio" value="1"> <br>
            </div>
            <div>
                &emsp;
                <div>
                    <input type="checkbox" id="GRADUAL_CONSUMPTION" checked="true"> Gradual Consumption

                    <input type="checkbox" id="GRADUAL_CONSUMPTION_RESPAWN" checked="true"> Food respawn when fully
                    consumed
                </div>

                <div>
                    Number of Ticks to Fully Consume: <input type="text" id="max_ticks_to_consume" value="50"> <br>
                </div>
                <div>
                    Number of Ticks for Food to reset overlapping counters: <input type="text" id="cooldown_to_regen"
                        value="100">
                    <br>
                </div>

                <br>
            </div>
        </div>



        <div class="container" style="border: 2px solid black; width: fit-content;">
            <div>
                <h1><strong>Agent Setting:</strong></h1>
            </div>

            <div>
                <input type="checkbox" id="agent_neighbors" checked="true"> Agent Neighbors
            </div>

            <div>
                <input type="checkbox" id="agent_vision_is_cone" checked="true"> Cone Vision for Agents (Proximity
                vision
                otherwise)
                <br>
                <input type="checkbox" id="agent_biting"> Agent biting required (Requires Restart)
            </div>
            <div>
                <input type="checkbox" id="displayOnTheSameWorld"> Display all on the first world
            </div>
            <div>
                <label for="num_prey">Number of prey in Simulation (Requires Restart):</label>
                <select name="num_prey" id="num_prey">
                    <option value="24">24</option>
                    <option value="48">48</option>
                    <option value="72">72</option>
                    <option value="96">96</option>
                    <option value="120">120</option>
                </select>
            </div>
            <div>
                <label for="predator_ratio">Ratio of prey to predator (Requires Restart):</label>
                <select name="predator_ratio" id="predator_ratio">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="6">6</option>
                    <option value="8">8</option>
                    <option value="12">12</option>
                </select>
            </div>
            <div>
                Neighbors Detected by Agents (Requires Restart): <input type="text" id="agent_neighbor_count" value="1">
            </div>

            <div>
                Agent per world (Put 0 to deactivate): <input type="text" id="agent_per_world" value="2"> <br>
                <div>
                    Agent Default Max Speed: <input type="text" id="agent_max_speed" value="5">
                </div>

                <div>
                    Agent Diameter: <input type="text" id="agent_diameter" value="15">
                </div>
            </div>

            <div>
                Agent Visual Radius (pixels): <input type="text" id="agent_vision_radius" value="400">
            </div>

            <div>
                Vision Rays: <input type="text" id="agent_vision_rays" value="13">
            </div>

            <div>
                Vision Cone Angle (degrees): <input type="text" id="agent_vision_angle" value="180">
            </div>
            <br>
        </div>


    </div>

    <div style="display:flex; flex-wrap:inherit; width: fit-content; margin:auto;">
        <div class="container" style="border: 2px solid black; width: fit-content;">
            <div>
                <br>
                <h1><strong>Hunting Mode Setting:</strong></h1>
            </div>

            <div>
                <label for="huntingMode"> Hunting Mode (Restart to take effect) </label>
                <select name="huntingMode" id="huntingMode">
                    <option value="deactivated">Deactivated</option>
                    <option selected="selected" value="hierarchy">Food Hierarchy Index</option>
                    <option value="hierarchy_spectrum">Food Hierarchy Index Spectrum (Multiple Prey/Predator levels)
                    </option>
                    <option value="multipleGeneration">Multiple Generation</option>
                </select>
                <br>
                Prey Max Speed: <input type="text" id="prey_speed" value="5"> <br>
                Predator Max Speed: <input type="text" id="predator_speed" value="5"> <br>

                <input type="checkbox" id="inactive_prey_targetable" name="inactive_prey_targetable" checked="true">
                Prey Is Targetable When Dead
                <br>
                <input type="checkbox" id="push_fhi_to_ann" checked="true"> Push Food Hierarchy Index to ANN
                <br>
            </div>

            <div>
                <input type="checkbox" id="mirror_roles" checked="true"> Mirrored Prey-Predator Roles Runs (restart
                to
                take
                effect)
            </div>
        </div>
        <div class="container" style="border: 2px solid black; width: fit-content;">
            <br>
            <h1><strong>Fitness Function:</strong></h1>
            <div>
                <!-- Old fitness function -->
                <h5><strong>Specific Agent Fitness Function = </strong></h5>
                <input type="text" id="FITNESS_HUNTING_PREY" value="50"> (Prey hunted) +
                <input type="text" id="FITNESS_BUMPING_INTO_WALL" value="0"> (Bumping Into Wall) +
                <input type="text" id="FITNESS_OUT_OF_BOUND" value="-2"> (Out of bound) +
                <input type="text" id="fitness_calories" value="10"> (Calories Eaten) +
                <input type="text" id="fitness_potential_cal" value="0"> (Potential Calories Reward)
                <br> </br>
            </div>


            <div>
                <h5><strong>Generalized Agent Fitness Function = </strong></h5>
                <input type="text" id="FITNESS_ENERGY_EFFICIENCY" value="0"> Energy Efficiency (calories
                gained/calories
                spent)
                +
                <input type="text" id="FITNESS_PERCENT_DEAD" value="0"> Percentage of Ticks Dead +
                <input type="text" id="FITNESS_WINNER_BONUS" value="50"> Winner Bonus
                <br> </br>
            </div>
        </div>
    </div>

    <div id="charts" style="flex-wrap:wrap;" class="container">
        <h1><strong>Charts: </strong><br></h1>
        <div id="agentCurrentOutputContainers">

        </div>
        <div id="agentAvgOutputContainers">

        </div>

        <div id="lineChartOutputContainters">

        </div>

        <div id="barChartContainer">
        </div>

        <div id="currentFitnessChartContainer">
            <div id="currentFitnessChart"></div>
        </div>
        <div id="fitnessChartContainer">
            <div id="fitnessChart"></div>
        </div>
        <!-- <div id="carouselFitnessIndicators" class="carousel carousel-dark" data-bs-ride="carousel">
            <div id="fitness-indicators" class="carousel-indicators">
            </div>
            <div id="fitness-carousel" class="carousel-inner">
            </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselFitnessIndicators" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselFitnessIndicators" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
        </div> -->


        <div id="foodConsumptionChartContainer">
            <canvas id="foodConsumptionChart"></canvas>
        </div>
        <!--
            <div id="foodTimeChartContainer">
            <canvas id="foodTimeChart"></canvas>
        </div>
        <div id="connectionChartContainer">
            <canvas id="connectionChart"></canvas>
        </div>
        <div id="nodeChartContainer">
            <canvas id="nodeChart"></canvas>
        </div>
        <div id="foodLifeStageChartContainer">
            <canvas id="foodLifeStageChart"></canvas>
        </div>
        <div id="ageChartContainer">
            <canvas id="ageChart"></canvas>
        </div>
        <div id="cycleChartContainer">
            <canvas id="cycleChart"></canvas>
        </div>
        -->

    </div>

</body>

</html>